{{!-- HTMl that displays a restaurant's menu and user cart --}}
{{!-- Author(s): David --}}
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/stylesheets/sfsu-user-pages-css/restaurant-menu-cart.css">
</head>
<body>
    <div class = "center">
        <h1 class="rest-name">{{title}}</h1>
        <div class="box">
            <div class="wrapper">
                <div class = "wrapper2">
                    {{#each menu}}
                    <div class = "menu-box">
                        <image src={{images}} width="300" height="300"></image>
                        <hr>
                        <h3>{{name}}</h3>
                        <hr>
                        <p>{{description}}</p>
                        <hr>
                        <h5>{{price}}</h5>
                        <button class="button" name="add" id={{menuID}}>add to cart</button>
                    </div>
                    {{/each}}
                </div>
                <div class="cart"> 
                    <h3>Cart</h3>
                    <hr>
                    <div class = "cart-scroll" id = "cart-scroll">
                        
                    </div>
                    <hr>
                    <h4 style="display:inline">Total: </h4><h4 style="display:inline" id="totalPrice">0.00</h4>
                    <br>
                    <a  href ="/checkOut" class="checkOut-button">Check Out</a>
                </div>
            </div>
        </div>
    </div> 
</body>

<script>
    var test = [];
    var total = 0;
    document.querySelectorAll('[name="add"]').forEach(addButton => {
        addButton.addEventListener('click', () => {
            var buttonID = event.srcElement.parentNode.firstElementChild;
            var image = buttonID.src;
            test.push(image);
            var nameElement = buttonID.nextElementSibling.nextElementSibling;
            var name = nameElement.innerText;
            test.push(name);
            var price = nameElement.nextElementSibling.nextElementSibling.nextElementSibling.nextElementSibling.innerText;
            test.push(price);
            total += parseFloat(price);
            let div = document.createElement('div');
            div.innerHTML = `
                <div class ="cart-container">
                        <image class="cart-photo" src="`+ image + `" width="50" height="50"></image>
                        <h6>` + name + `</h6>
                        <h6>Qtn:<input type="number" id="quantity" name="quantity" value="1" min = "1" max="5"></h6>
                        <h6 class="itemPrice">$` + price +`</h6>
                </div>
                <br>
            `;
            document.getElementById('cart-scroll').appendChild(div);
            document.getElementById('totalPrice').innerText = formatter.format(total);
        });
    });

    //Source used: https://stackoverflow.com/questions/149055/how-to-format-numbers-as-currency-strings
   const formatter = new Intl.NumberFormat('en-US', {
        style: 'currency',
        currency: 'USD',
    });
</script>
